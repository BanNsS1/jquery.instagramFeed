(function(a){function b(a){return a.replace(/[&<>"'`=\/]/g,function(a){return f[a]})}function c(a,b){var c,d,e,f,g,h=a.node;return null!==h&&void 0!==h&&null!==(c=h.edge_media_to_caption)&&void 0!==c&&null!==(d=c.edges[0])&&void 0!==d&&null!==(e=d.node)&&void 0!==e&&e.text?h.edge_media_to_caption.edges[0].node.text:null!==h&&void 0!==h&&null!==(f=h.title)&&void 0!==f&&f.length?h.title:null!==h&&void 0!==h&&null!==(g=h.accessibility_caption)&&void 0!==g&&g.length?h.accessibility_caption:"".concat(this.is_tag?b.name:b.username," image ")}var d={host:"https://www.instagram.com/",username:"",tag:"",container:"",display_profile:!0,display_biography:!0,display_gallery:!0,display_captions:!1,display_igtv:!1,callback:null,styling:!0,items:8,items_per_row:4,margin:.5,image_size:640,lazy_load:!1,cache_time:360,on_error:console.error},e={150:0,240:1,320:2,480:3,640:4},f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};a.instagramFeed=function(f){function g(d){if("string"==typeof d){try{d=d.split("window._sharedData = ")[1].split("</script>")[0]}catch(a){return void h.on_error("Instagram Feed: It looks like the profile you are trying to fetch is age restricted. See https://github.com/jsanahuja/InstagramFeed/issues/26",3)}d=JSON.parse(d.substr(0,d.length-1)),d=d.entry_data.ProfilePage||d.entry_data.TagPage;var f=!1;if("undefined"==typeof d){var g=localStorage.getItem(l);if(null!==g&&(d=JSON.parse(g),f=!0),h.on_error("Instagram Feed: Your network has been temporary banned by Instagram because of too many requests. Consider increasing your \"cache_time\". See https://github.com/jsanahuja/jquery.instagramFeed/issues/25 and https://github.com/jsanahuja/jquery.instagramFeed/issues/101",4),!d)return}!f&&0<h.cache_time&&(localStorage.setItem(l,JSON.stringify(d)),localStorage.setItem(m,new Date().getTime()))}if(d=d[0].graphql.user||d[0].graphql.hashtag,""!=h.container){var j,k="";if(h.styling){var n=(100-2*h.margin*h.items_per_row)/h.items_per_row;j={profile_container:" style=\"text-align:center;\"",profile_image:" style=\"border-radius:10em;width:15%;max-width:125px;min-width:50px;\"",profile_name:" style=\"font-size:1.2em;\"",profile_biography:" style=\"font-size:1em;\"",gallery_image:" style=\"width:100%;\"",gallery_image_link:" style=\"width:".concat(n,"%; margin:").concat(h.margin,"%;position:relative; display: inline-block; height: 100%;\"")},h.display_captions&&(k+="<style>\n                            a[data-caption]:hover::after {\n                                content: attr(data-caption);\n                                text-align: center;\n                                font-size: 0.8rem;\n                                color: black;\n                                position: absolute;\n                                left: 0;\n                                right: 0;\n                                bottom: 0;\n                                padding: 1%;\n                                max-height: 100%;\n                                overflow-y: auto;\n                                overflow-x: hidden;\n                                background-color: hsla(0, 100%, 100%, 0.8);\n                            }\n                        </style>")}else j={profile_container:"",profile_image:"",profile_name:"",profile_biography:"",gallery_image:"",gallery_image_link:""};h.display_profile&&(k+="<div class=\"instagram_profile\"".concat(j.profile_container,">"),k+="<img class=\"instagram_profile_image\" src=\"".concat(d.profile_pic_url,"\" alt=\"").concat(i?d.name+" tag pic":d.username+" profile pic","\" ").concat(j.profile_image," ").concat(h.lazy_load?"loading=\"lazy\"":""," />"),k+=i?"<p class=\"instagram_tag\" ".concat(j.profile_name,"><a href=\"https://www.instagram.com/explore/tags/").concat(h.tag,"\" rel=\"noopener\" target=\"_blank\">#").concat(h.tag,"</a></p>"):"<p class=\"instagram_username\"".concat(j.profile_name,">@").concat(d.full_name," (<a href=\"https://www.instagram.com/").concat(h.username,"\" rel=\"noopener\" target=\"_blank\">@").concat(h.username,"</a>)</p>"),!i&&h.display_biography&&(k+="<p class=\"instagram_biography\" ".concat(j.profile_biography,">").concat(d.biography,"</p>")),k+="</div>");var o="undefined"==typeof e[h.image_size]?e[640]:e[h.image_size];if(h.display_gallery)if("undefined"!=typeof d.is_private&&!0===d.is_private)k+="<p class=\"instagram_private\"><strong>This profile is private</strong></p>";else{var p=(d.edge_owner_to_timeline_media||d.edge_hashtag_to_media).edges;max=p.length>h.items?h.items:p.length,k+="<div class=\"instagram_gallery\">";for(var q=0;q<max;q++){var i="https://www.instagram.com/p/".concat(p[q].node.shortcode),r=void 0,s=void 0,t=b(c(p[q],d));switch(p[q].node.__typename){case"GraphSidecar":s="sidecar",r=p[q].node.thumbnail_resources[o].src;break;case"GraphVideo":s="video",r=p[q].node.thumbnail_src;break;default:s="image",r=p[q].node.thumbnail_resources[o].src;}k+="<a href=\"".concat(i,"\" ").concat(h.display_captions?"data-caption=\""+t+"\"":""," class=\"instagram-").concat(s,"\" rel=\"noopener\" target=\"_blank\" ").concat(j.gallery_image_link,">"),k+="<img ".concat(h.lazy_load?" loading=\"lazy\"":""," src=\"").concat(r,"\" alt=\"").concat(t,"\"' ").concat(j.gallery_image," />"),k+="</a>"}k+="</div>"}if(h.display_igtv&&"undefined"!=typeof d.edge_felix_video_timeline){var u=d.edge_felix_video_timeline.edges,v=u.length>h.items?h.items:u.length;if(0<u.length){k+="<div class=\"instagram_igtv\">";for(var w=0;w<v;w++){var x="https://www.instagram.com/p/".concat(u[w].node.shortcode),y=b(c(u[w],d));k+="<a href=\"".concat(x,"\" ").concat(h.display_captions?" data-caption=\""+y+"\"":""," rel=\"noopener\" target=\"_blank\" ").concat(j.gallery_image_link,">"),k+="<img ".concat(h.lazy_load?" loading=\"lazy\"":""," src=\"").concat(u[w].node.thumbnail_src,"\" alt=\"").concat(y,"\" ").concat(j.gallery_image," />"),k+="</a>"}k+="</div>"}}a(h.container).html(k)}null!=h.callback&&h.callback(d)}var h=a.fn.extend({},d,f);if(""==h.username&&""==h.tag)return h.on_error("Instagram Feed: Error, no username nor tag defined.",1),!1;if("undefined"!=typeof h.get_data&&console.warn("Instagram Feed: options.get_data is deprecated, options.callback is always called if defined"),null==h.callback&&""==h.container)return h.on_error("Instagram Feed: Error, neither container found nor callback defined.",2),!1;var i=""==h.username,j=i?"".concat(h.host,"explore/tags/").concat(h.tag,"/"):"".concat(h.host).concat(h.username,"/"),k=null,l="instagramFeed_".concat(i?"t_"+h.tag:"u_"+h.username),m="".concat(l,"_cached");if(0<h.cache_time){var n=localStorage.getItem(m);if(null!==n&&parseInt(n)+60000*h.cache_time>new Date().getTime()){var o=localStorage.getItem(l);null!==o&&(k=JSON.parse(o))}}return null===k?a.get(j,g).fail(function(a){h.on_error("Instagram Feed: Unable to fetch the given user/tag. Instagram responded with the status code: ".concat(a.status),5)}):g(k),!0}})(jQuery);
